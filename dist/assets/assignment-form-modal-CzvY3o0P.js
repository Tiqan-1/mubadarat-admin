import{aa as l,r as f,b as m,j as e,au as g,at as s,av as n,aw as K,ag as c}from"./index-DN_LE4ff.js";import{d as v}from"./dayjs.min-B92MZlCX.js";import{a as R}from"./levels-BcrHyLxu.js";import{s as W}from"./subjects-CNueMXU8.js";import{p as z}from"./programs-BpIXPJfC.js";import{S as o}from"./index-DzWKCnLv.js";import{D as y}from"./index-KTjjIOW4.js";function J({title:I,show:q,initialValues:r,okDisabled:F,onOk:S,onCancel:w}){var x,j,b;const[i]=l.useForm(),[u,P]=f.useState(void 0);f.useEffect(()=>{i.setFieldsValue({...r})},[r,i]);const k=m({queryKey:["programs"],queryFn:()=>z.get(),refetchOnWindowFocus:!1}),A=m({queryKey:["levels",u],enabled:!!u,queryFn:()=>R.get({programId:u}),refetchOnWindowFocus:!1}),O=m({queryKey:["subjects"],queryFn:()=>W.get({}),refetchOnWindowFocus:!1}),p=(x=k.data)==null?void 0:x.items.map(({id:a,name:t})=>({value:a,label:e.jsx("span",{children:t})}));p==null||p.unshift({value:"",label:e.jsx("span",{children:""})});const C=(j=A.data)==null?void 0:j.items.map(({id:a,name:t})=>({value:a,label:e.jsx("span",{children:t})})),d=(b=O.data)==null?void 0:b.items.map(({id:a,name:t})=>({value:a,label:e.jsx("span",{children:t})}));d==null||d.unshift({value:"",label:e.jsx("span",{children:""})});const M=[{value:g.exam,label:e.jsx("span",{children:s("app.assignments.types.exam")})},{value:g.homework,label:e.jsx("span",{children:s("app.assignments.types.homework")})}],T=[{value:n.draft,label:e.jsx("span",{children:s("app.assignments.states.draft")})},{value:n.published,label:e.jsx("span",{children:s("app.assignments.states.published")})},{value:n.canceled,label:e.jsx("span",{children:s("app.assignments.states.canceled")})},{value:n.closed,label:e.jsx("span",{children:s("app.assignments.states.closed")})},{value:n.deleted,label:e.jsx("span",{children:s("app.assignments.states.deleted")})}],E=a=>{P(a),i.setFieldsValue({levelId:null})},h={getValueProps:a=>({value:a&&v(a)}),normalize:a=>a&&`${v(a).toISOString()}`};return e.jsxs(K,{forceRender:!0,title:I,open:q,okButtonProps:{autoFocus:!0,htmlType:"submit",disabled:F},okText:r.id===void 0?s("common.create"):s("common.edit"),cancelText:s("common.cancel"),onCancel:w,modalRender:a=>e.jsx(l,{form:i,initialValues:r,onFinish:t=>S(r.id,t),labelCol:{span:6},wrapperCol:{span:18},layout:"horizontal",children:a}),children:[e.jsx(l.Item,{label:s("app.fields.type"),name:"type",rules:[{required:!0}],children:e.jsx(o,{showSearch:!0,options:M})}),e.jsx(l.Item,{label:s("app.fields.title"),name:"title",rules:[{required:!0}],children:e.jsx(c,{})}),e.jsx(l.Item,{label:s("app.fields.program"),name:"programId",children:e.jsx(o,{showSearch:!0,options:p,onChange:E})}),e.jsx(l.Item,{label:s("app.fields.level"),name:"levelId",rules:[{required:!0}],children:e.jsx(o,{showSearch:!0,options:C})}),e.jsx(l.Item,{label:s("app.fields.subject"),name:"subjectId",children:e.jsx(o,{showSearch:!0,options:d})}),r.id&&e.jsx(l.Item,{label:s("app.fields.state"),name:"state",rules:[{required:!0}],children:e.jsx(o,{showSearch:!0,options:T})}),e.jsx(l.Item,{label:s("app.fields.durationInMinutes"),name:"durationInMinutes",rules:[{required:!0}],children:e.jsx(c,{type:"number"})}),e.jsx(l.Item,{label:s("app.fields.passingScore"),name:"passingScore",rules:[{required:!0}],children:e.jsx(c,{type:"number"})}),e.jsx(l.Item,{label:s("app.fields.availableFrom"),name:"availableFrom",...h,rules:[{required:!0}],children:e.jsx(y,{})}),e.jsx(l.Item,{label:s("app.fields.availableUntil"),name:"availableUntil",...h,rules:[{required:!0}],children:e.jsx(y,{})})]})}export{J as default};
