import{an as S,u as k,r as m,b as C,ac as P,j as e,ao as F,c as T,B as p,aq as z,I as u,S as E,ar as v}from"./index-DN_LE4ff.js";import{F as _}from"./Table-DvCu9zyw.js";import{l as f}from"./lessons-B_wNNqRB.js";import{useLessonModal as D}from"./use-lesson-modal-Cl-TSzAf.js";import L from"./lesson-form-modal-DoYa4tU5.js";import N from"./lesson-filter-gUnmixTK.js";import{P as O}from"./index-fEMJRJ1s.js";import{C as q}from"./index-DjR-mQpu.js";import"./index-DzWKCnLv.js";import"./index-C4LaZWfl.js";import"./subjects-CNueMXU8.js";const B={video:"processing",pdf:"warning",other:"error"};function X(){const[i]=S(),{t:s}=k(),[n,a]=m.useState(Object.fromEntries(i.entries())),{data:r,refetch:l,isLoading:c,isFetching:d}=C({queryKey:["lessons",n],queryFn:()=>f.get(n),refetchOnWindowFocus:!1}),{modalProps:x,onCreate:h,onEdit:j}=D(()=>l()),g=P({mutationFn:t=>(console.log("mutationDelete",t),n.subjectId?f.destroy(n.subjectId,t):(alert("Unkown lesson parent(subjectId)"),Promise.resolve())),onSuccess(){l()}});m.useEffect(()=>{a(Object.fromEntries(i.entries()))},[i]);function y(t){console.log("onSearch",t),a(t)}function b(){a({})}const w=t=>{console.log("delete ",t),g.mutate(t.id)},I=[{title:s("app.fields.id"),dataIndex:"id",width:100,render:(t,o)=>e.jsx(F,{copyable:!0,ellipsis:!0,children:o.id})},{title:s("app.fields.name"),dataIndex:"title",render:(t,o)=>e.jsx("div",{children:o.title})},{title:s("app.fields.file type"),dataIndex:"type",render:(t,o)=>e.jsx(T,{color:B[o.type],children:o.type})},{title:s("app.fields.url"),dataIndex:"url",render:(t,o)=>e.jsx(p,{color:"default",variant:"link",target:"_blank",href:o.url,children:o.url})},{title:s("common.action"),dataIndex:"operation",width:100,render:(t,o)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(z,{onClick:()=>j(o),children:e.jsx(u,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(O,{title:s("common.confirm-deleting"),okText:s("common.ok"),cancelText:s("common.cancel"),placement:"left",onConfirm:()=>w(o),children:e.jsx("button",{type:"button",children:e.jsx(u,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(E,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(N,{formValue:n,okDisabled:c||d,onClear:b,onSearch:y}),e.jsxs(q,{title:s("app.lessons.grid-header"),extra:e.jsxs(p,{type:"primary",onClick:()=>h(),children:[" ",s("common.create")," "]}),children:[e.jsx(_,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:I,locale:{emptyText:e.jsx(v,{description:"No Data",children:"Please select a subject"})},dataSource:r==null?void 0:r.items,loading:c||d,pagination:{pageSizeOptions:[10,30,50],current:n.page??1,showSizeChanger:!0,showQuickJumper:!0,total:r==null?void 0:r.total,onChange:(t,o)=>a({...n,page:t,pageSize:o})}}),e.jsx(L,{...x})]})]})}export{X as default};
