import{u as F,ab as E,r as T,b as N,ac as u,j as e,ao as x,B as f,I as o,aq as h,S as q,D as B}from"./index-XWZJOGTG.js";import{F as L}from"./Table-DyVP6gkK.js";import{p as c}from"./programs-zQla2BAp.js";import{useProgramModal as g}from"./use-program-modal-CNpiT1r4.js";import j from"./program-form-modal-27g0VUq0.js";import $ from"./program-filter-ZlEgsrDk.js";import{d as l}from"./dayjs.min-D9M4XKf5.js";import{P as b}from"./index-Cw4yL3qI.js";import{C as K}from"./index-Ddyc13Qi.js";import"./index-DCIFzzg3.js";import"./index-2_gLb7eb.js";import"./index-CfF7_bgE.js";function ee(){const{t:a}=F(),y=E(),[n,d]=T.useState({}),{data:r,refetch:s,isLoading:m,isFetching:p}=N({queryKey:["programs",n],queryFn:()=>c.get(n),refetchOnWindowFocus:!1}),{modalProps:Y,onCreate:I,onEdit:v}=g(!1,()=>s()),{modalProps:k,onEdit:D}=g(!0,()=>s()),C=u({mutationFn:i=>c.destroy(i),onSuccess(){s()}}),S=u({mutationFn:i=>c.update(i,{state:"published"}),onSuccess(){s()}});function w(i){d(i)}function M(){d({})}const P=i=>{C.mutate(i.id)},_=i=>{S.mutate(i.id)},z=[{title:a("app.fields.id"),dataIndex:"id",width:100,render:(i,t)=>e.jsx(x,{copyable:!0,ellipsis:!0,children:t.id})},{title:a("app.fields.name"),dataIndex:"name",fixed:"left",render:(i,t)=>e.jsx("div",{children:t.name})},{title:a("app.fields.thumbnail"),dataIndex:"name",render:(i,t)=>t.thumbnail&&e.jsx("img",{width:50,height:50,src:`data:image/png;base64,${t.thumbnail}`,alt:"thumbnail"})},{title:a("app.fields.state"),dataIndex:"state",render:(i,t)=>e.jsx("div",{children:a(`app.programs.statuses.${t.state}`)})},{title:a("app.fields.description"),dataIndex:"description",width:300,render:(i,t)=>e.jsx(x,{copyable:!0,ellipsis:!0,children:t.description})},{title:a("app.fields.start"),dataIndex:"start",render:(i,t)=>e.jsx("div",{children:l(t.start).format("YYYY-MM-DD")})},{title:a("app.fields.end"),dataIndex:"end",render:(i,t)=>e.jsx("div",{children:l(t.end).format("YYYY-MM-DD")})},{title:a("app.fields.registration start"),dataIndex:"registrationStart",render:(i,t)=>e.jsx("div",{children:l(t.registrationStart).format("YYYY-MM-DD")})},{title:a("app.fields.registration end"),dataIndex:"registrationEnd",render:(i,t)=>e.jsx("div",{children:l(t.registrationEnd).format("YYYY-MM-DD")})},{title:a("app.levels.title"),dataIndex:"registrationEnd",render:(i,t)=>e.jsx(f,{onClick:()=>y(`/levels?programId=${t.id}`),icon:e.jsx(o,{icon:"solar:layers-minimalistic-broken",size:18}),children:a("app.levels.title")})},{title:a("common.action"),dataIndex:"operation",width:100,fixed:"right",render:(i,t)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(h,{onClick:()=>D(t,a("app.fields.thumbnail")),children:e.jsx(o,{icon:"solar:camera-outline",size:18})}),e.jsx(h,{onClick:()=>v(t),children:e.jsx(o,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(b,{title:a("common.confirm-launch"),okText:a("common.ok"),cancelText:a("common.cancel"),placement:"left",onConfirm:()=>_(t),children:e.jsx("button",{type:"button",children:e.jsx(o,{icon:"solar:rocket-2-broken",size:18,className:"text-success-light"})})}),e.jsx(b,{title:a("common.confirm-deleting"),okText:a("common.ok"),cancelText:a("common.cancel"),placement:"left",onConfirm:()=>P(t),children:e.jsx("button",{type:"button",children:e.jsx(o,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(q,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx($,{formValue:n,okDisabled:m||p,onClear:M,onSearch:w}),e.jsx(B,{children:a("app.programs.grid-header")}),e.jsxs(K,{title:a("app.programs.grid-header"),extra:e.jsxs(f,{type:"primary",onClick:()=>I(),children:[" ",a("common.create")," "]}),children:[e.jsx(L,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:z,dataSource:r==null?void 0:r.items,loading:m||p,pagination:{pageSizeOptions:[10,30,50],current:n.page??1,showSizeChanger:!0,showQuickJumper:!0,total:r==null?void 0:r.total,onChange:(i,t)=>d({...n,page:i,pageSize:t})}}),e.jsx(j,{...Y}),e.jsx(j,{...k})]})]})}export{ee as default};
