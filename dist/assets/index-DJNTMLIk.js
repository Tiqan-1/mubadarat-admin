import{an as y,u as v,r as w,b as I,ac as F,j as e,ao as z,c as C,aq as P,I as p,S as T,D as _}from"./index-XWZJOGTG.js";import{F as k}from"./Table-DyVP6gkK.js";import{u as D,a as m}from"./use-subscription-modal-2cnpXyQG.js";import E from"./subscription-form-modal-2SpChy38.js";import q from"./subscription-filter-BAffRaY9.js";import{P as M}from"./index-Cw4yL3qI.js";import{C as N}from"./index-Ddyc13Qi.js";import"./index-DCIFzzg3.js";import"./index-2_gLb7eb.js";import"./programs-zQla2BAp.js";const O={active:"processing",succeeded:"success",failed:"default",suspended:"warning",deleted:"error"};function H(){const[u]=y(),{t:s}=v(),[a,o]=w.useState(Object.fromEntries(u.entries())),{data:n,refetch:c,isLoading:l,isFetching:d}=I({queryKey:["subscriptions",a],queryFn:()=>m.get(a),refetchOnWindowFocus:!1}),{modalProps:x,onEdit:f}=D(()=>c()),h=F({mutationFn:i=>m.destroy(i),onSuccess(){c()}});function g(i){o(i)}function j(){o({})}const b=i=>{h.mutate(i.id)},S=[{title:s("app.fields.id"),dataIndex:"id",width:100,render:(i,t)=>e.jsx(z,{copyable:!0,ellipsis:!0,children:t.id})},{title:s("app.fields.name"),dataIndex:"name",render:(i,t)=>{var r;return e.jsx("div",{children:(r=t.subscriber)==null?void 0:r.name})}},{title:s("app.fields.program"),dataIndex:"description",render:(i,t)=>{var r;return e.jsx("div",{children:(r=t.program)==null?void 0:r.name})}},{title:s("app.fields.level"),dataIndex:"description",render:(i,t)=>{var r;return e.jsx("div",{children:(r=t.level)==null?void 0:r.name})}},{title:s("app.fields.state"),dataIndex:"type",render:(i,t)=>e.jsx(C,{color:O[t.state],children:t.state})},{title:s("app.fields.note"),dataIndex:"description",render:(i,t)=>e.jsx("div",{children:t.notes})},{title:s("common.action"),dataIndex:"operation",width:100,render:(i,t)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(P,{onClick:()=>f(t),children:e.jsx(p,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(M,{title:s("common.confirm-deleting"),okText:s("common.ok"),cancelText:s("common.cancel"),placement:"left",onConfirm:()=>b(t),children:e.jsx("button",{type:"button",children:e.jsx(p,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(T,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(q,{formValue:a,okDisabled:l||d,onClear:j,onSearch:g}),e.jsx(_,{children:s("app.subscriptions.grid-header")}),e.jsxs(N,{title:s("app.subscriptions.grid-header"),children:[e.jsx(k,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:S,dataSource:n==null?void 0:n.items,loading:l||d,pagination:{pageSizeOptions:[10,30,50],current:a.page??1,showSizeChanger:!0,showQuickJumper:!0,total:n==null?void 0:n.total,onChange:(i,t)=>o({...a,page:i,pageSize:t})}}),e.jsx(E,{...x})]})]})}export{H as default};
