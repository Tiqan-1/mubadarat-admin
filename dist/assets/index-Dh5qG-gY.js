import{ab as w,an as D,u as I,r as p,b as z,ac as F,j as e,ao as P,B as u,I as l,aq as Y,S as E,ar as M}from"./index-DN_LE4ff.js";import{F as L}from"./Table-DvCu9zyw.js";import{a as f}from"./levels-BcrHyLxu.js";import{useLevelModal as N}from"./use-level-modal-DI8iw9u5.js";import T from"./level-form-modal-DWUhKgwL.js";import _ from"./level-filter-BpvmeQrr.js";import{d as x}from"./dayjs.min-B92MZlCX.js";import{P as O}from"./index-fEMJRJ1s.js";import{C as q}from"./index-DjR-mQpu.js";import"./index-DzWKCnLv.js";import"./index-C4LaZWfl.js";import"./programs-BpIXPJfC.js";import"./index-KTjjIOW4.js";function Z(){const h=w(),[i]=D(),{t:a}=I(),[n,r]=p.useState(Object.fromEntries(i.entries())),{data:s,refetch:c,isLoading:d,isFetching:m}=z({queryKey:["levels",n],queryFn:()=>f.get(n),refetchOnWindowFocus:!1}),{modalProps:j,onCreate:g,onEdit:y}=N(()=>c()),v=F({mutationFn:t=>(console.log("mutationDelete",t),f.destroy(t)),onSuccess(){c()}});p.useEffect(()=>{r(Object.fromEntries(i.entries()))},[i]);function b(t){console.log("onSearch",t),r(t)}function S(){r({})}const k=t=>{console.log("delete ",t),v.mutate(t.id)},C=[{title:a("app.fields.id"),dataIndex:"id",width:100,render:(t,o)=>e.jsx(P,{copyable:!0,ellipsis:!0,children:o.id})},{title:a("app.fields.name"),dataIndex:"name",render:(t,o)=>e.jsx("div",{children:o.name})},{title:a("app.fields.start"),dataIndex:"start",render:(t,o)=>e.jsx("div",{children:x(o.start).format("YYYY-MM-DD")})},{title:a("app.fields.end"),dataIndex:"end",render:(t,o)=>e.jsx("div",{children:x(o.end).format("YYYY-MM-DD")})},{title:a("common.action"),dataIndex:"operation",width:100,render:(t,o)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(u,{onClick:()=>h(`/tasks?levelId=${o.id}`),icon:e.jsx(l,{icon:"solar:bill-list-broken",size:18}),children:a("app.tasks.title")}),e.jsx(Y,{onClick:()=>y(o),children:e.jsx(l,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(O,{title:a("common.confirm-deleting"),okText:a("common.ok"),cancelText:a("common.cancel"),placement:"left",onConfirm:()=>k(o),children:e.jsx("button",{type:"button",children:e.jsx(l,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(E,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(_,{formValue:n,okDisabled:d||m,onClear:S,onSearch:b}),e.jsxs(q,{title:a("app.levels.grid-header"),extra:e.jsxs(u,{type:"primary",onClick:()=>g(),children:[" ",a("common.create")," "]}),children:[e.jsx(L,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:C,locale:{emptyText:e.jsx(M,{description:"No Data",children:"Please select a program"})},dataSource:s==null?void 0:s.items,loading:d||m,pagination:{pageSizeOptions:[10,30,50],current:n.page??1,showSizeChanger:!0,showQuickJumper:!0,total:s==null?void 0:s.total,onChange:(t,o)=>r({...n,page:t,pageSize:o})}}),e.jsx(T,{...j})]})]})}export{Z as default};
