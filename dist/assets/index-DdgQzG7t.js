import{an as I,u as T,r as p,b as v,ac as D,j as e,ao as F,aq as P,I as u,S as x,D as z,ar as E,B as _}from"./index-DN_LE4ff.js";import{F as M}from"./Table-DvCu9zyw.js";import{u as N,a as f}from"./use-task-modal-_7llXhii.js";import O from"./task-form-modal-CGNNulPK.js";import Y from"./task-filter-DHpchbsL.js";import{d as q}from"./dayjs.min-B92MZlCX.js";import{P as B}from"./index-fEMJRJ1s.js";import{C as K}from"./index-DjR-mQpu.js";import"./index-DzWKCnLv.js";import"./index-C4LaZWfl.js";import"./levels-BcrHyLxu.js";import"./lessons-B_wNNqRB.js";import"./subjects-CNueMXU8.js";import"./programs-BpIXPJfC.js";import"./index-KTjjIOW4.js";function se(){const[l]=I(),{t:a}=T(),[n,r]=p.useState(Object.fromEntries(l.entries())),{data:i,refetch:c,isLoading:d,isFetching:m}=v({queryKey:["tasks",n],queryFn:()=>f.get(n),refetchOnWindowFocus:!1}),{modalProps:h,onCreate:j,onEdit:g}=N(()=>c()),y=D({mutationFn:s=>f.destroy(s),onSuccess(){c()}});p.useEffect(()=>{r(Object.fromEntries(l.entries()))},[l]);function k(s){r(s)}function w(){r({})}const S=s=>{y.mutate(s.id)},b=[{title:a("app.fields.id"),dataIndex:"id",width:100,render:(s,t)=>e.jsx(F,{copyable:!0,ellipsis:!0,children:t.id})},{title:a("app.fields.date"),dataIndex:"date",render:(s,t)=>e.jsx("div",{children:q(t.date).format("YYYY-MM-DD")})},{title:a("app.fields.note"),dataIndex:"note",render:(s,t)=>e.jsx("div",{children:t.note})},{title:a("app.lessons.title"),dataIndex:"lessons",render:(s,t)=>{var o;return e.jsx("div",{children:((o=t.lessons)==null?void 0:o.map(C=>C.title).join(", "))??"-"})}},{title:a("app.fields.assignment"),dataIndex:"assignment",render:(s,t)=>{var o;return e.jsx("div",{children:((o=t.assignment)==null?void 0:o.title)??"-"})}},{title:a("common.action"),dataIndex:"operation",width:100,render:(s,t)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(P,{onClick:()=>g(t),children:e.jsx(u,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(x,{style:{width:10},children:" "}),e.jsx(B,{title:a("common.confirm-deleting"),okText:a("common.ok"),cancelText:a("common.cancel"),placement:"left",onConfirm:()=>S(t),children:e.jsx("button",{type:"button",children:e.jsx(u,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(x,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(Y,{formValue:n,okDisabled:d||m,onClear:w,onSearch:k}),e.jsx(z,{children:a("app.tasks.grid-header")}),e.jsxs(K,{extra:e.jsxs(_,{type:"primary",onClick:()=>j(),children:[" ",a("common.create")," "]}),children:[e.jsx(M,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:b,locale:{emptyText:e.jsx(E,{description:"No Data",children:"Please select a level"})},dataSource:i==null?void 0:i.items,loading:d||m,pagination:{pageSizeOptions:[10,30,50],current:n.page??1,showSizeChanger:!0,showQuickJumper:!0,total:i==null?void 0:i.total,onChange:(s,t)=>r({...n,page:s,pageSize:t})}}),e.jsx(O,{...h})]})]})}export{se as default};
